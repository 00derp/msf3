require 'testbase'

describe Msf::Simple::Framework do
	$msf.exploits.each_module do |m|
		e = $msf.exploits.create(m)
		it "#{m} should have compatible payloads" do
			if(not e.default_target)
				e.datastore['TARGET'] = 0
			end
			
			r = e.compatible_payloads
			r.length.should_not == 0
		end
	end
end
